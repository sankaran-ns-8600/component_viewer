!function(t,e,i){"use strict";var n="componentViewer",o=0,s={selector:".cv-item",loop:!0,overlayClose:!0,keyboardNav:!0,showCounter:!0,preloadAdjacentImages:!0,stageOnly:{enabled:!1,hideNavigation:!1},carousel:{enabled:!1,navThreshold:4},slideshow:null,theme:"dark",themeToggle:!0,onThemeChange:null,fullscreen:!0,swipeNav:!0,swipeToClose:!0,canShowTooltip:!0,toolbar:{download:!0,zoom:!0},zoom:{min:1,max:5,step:.01,wheelStep:.15,showPercentage:!1,onZoom:null},pdf:{workerSrc:null,cMapUrl:null,cMapPacked:!0,annotations:!0,autoFit:!0,autoFitMaxScale:2.5},supportedVideoFormats:null,supportedAudioFormats:null,toolbarItems:[],onDownload:null,itemData:null,onRender:null,onToolbar:null,onLoading:null,onOpen:null,onClose:null,wcag:!1,pollOption:null},l={close:"Close",fullscreen:"Fullscreen",exitFullscreen:"Exit fullscreen",attachments:"Attachments",showAttachments:"Show attachments",scrollCarouselLeft:"Scroll carousel left",scrollCarouselRight:"Scroll carousel right",previousItem:"Previous item",nextItem:"Next item",zoomOut:"Zoom out",zoomLevel:"Zoom level",zoomIn:"Zoom in",switchToLightMode:"Switch to light mode",switchToDarkMode:"Switch to dark mode",playSlideshow:"Play slideshow",pauseSlideshow:"Pause slideshow",download:"Download",downloadSource:"Download source",invalidImageUrl:"Invalid or unsafe image URL",imageLoadFailed:"Image could not be loaded",play:"Play",pause:"Pause",playbackSpeed:"Playback Speed",mute:"Mute",unmute:"Unmute",thumbnails:"Thumbnails",previousPage:"Previous Page",nextPage:"Next Page",rotate:"Rotate",print:"Print",pdf:"PDF",previewNotAvailable:"Preview is not available for this file",file:"File",audio:"Audio",couldNotLoadFileInline:"Could not load file for inline view",noContentInline:"No content or invalid URL for inline view",noHtmlProvided:"No HTML provided for html view",typeVideo:"Video",typeCode:"Code",typeHtml:"HTML",typeError:"—",carouselItemLabel:"Item %1 of %2"};function a(e,i){var o=(t&&t.fn&&t.fn[n]&&t.fn[n].defaultStrings||l)[i];return null!=o&&""!==o?String(o):i}var r={close:"&times;",prev:"&#10094;",next:"&#10095;",zoomIn:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg>',zoomOut:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="8" y1="11" x2="14" y2="11"/></svg>',download:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>',fileIcon:'<svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>',error:'<svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="9" y1="9" x2="15" y2="15"/><line x1="15" y1="9" x2="9" y2="15"/></svg>',rotateCw:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>',prevPage:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>',nextPage:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>',thumbnails:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>',print:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>',themeLight:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>',themeDark:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>',fullscreen:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>',fullscreenExit:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="9" y1="9" x2="15" y2="15"/><line x1="15" y1="9" x2="9" y2="15"/></svg>',play:'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21"/></svg>'};function c(t){var e=null==t||""===t?"":"string"==typeof t?t:String(t),n=i.createElement("div");return n.appendChild(i.createTextNode(e)),n.innerHTML}function d(t){return(null==t||""===t?"file":"string"==typeof t?t:String(t)).replace(/[\0-\x1f<>:"/\\|?*\x7f]/g,"").trim()||"file"}function u(t){if(null==t||"string"!=typeof t)return!1;var e=t.trim().toLowerCase();if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:"))return!1;if(0===e.indexOf("http://")||0===e.indexOf("https://")||0===e.indexOf("blob:"))return!0;if(0===e.indexOf("data:")){var i=e.slice(5).split(",")[0].split(";")[0].trim();return 0===i.indexOf("image/")||0===i.indexOf("video/")||0===i.indexOf("audio/")||"application/pdf"===i}return!1}function p(t){if(null==t||"string"!=typeof t)return!1;var e=t.trim().toLowerCase();return 0!==e.indexOf("javascript:")&&0!==e.indexOf("vbscript:")&&0!==e.indexOf("data:")&&(0===e.indexOf("http://")||0===e.indexOf("https://")||0===e.indexOf("blob:"))}function h(t){if(null==t||"string"!=typeof t)return"";var e=i.createElement("div");e.innerHTML=t;for(var n=e.querySelectorAll("script"),o=0;o<n.length;o++)n[o].remove();for(var s=e.querySelectorAll("*"),l=0;l<s.length;l++){for(var a=s[l],r=[],c=0;c<a.attributes.length;c++)r.push(a.attributes[c].name);r.forEach(function(t){if(0===t.toLowerCase().indexOf("on"))a.removeAttribute(t);else if(("href"===t||"xlink:href"===t)&&a.getAttribute(t)){var e=(a.getAttribute(t)||"").trim().toLowerCase();0!==e.indexOf("javascript:")&&0!==e.indexOf("vbscript:")||a.setAttribute(t,"#")}})}return e.innerHTML}function v(t,e){if(t.supplied)return String(t.supplied).split(",")[0].trim();var i=t.type||"video",n={mp4:"m4v",m4v:"m4v",webm:"webmv",ogv:"ogv",flv:"flv",mp3:"mp3",m4a:"m4a",ogg:"oga",oga:"oga",wav:"wav",fla:"fla"}[(t.fileExt||(t.src||"").split(".").pop()||"").toLowerCase()]||("video"===i?"m4v":"mp3");if(e){var o="video"===i?e.opts.supportedVideoFormats:e.opts.supportedAudioFormats;if(o){var s=o.split(",").map(function(t){return t.trim()}).filter(Boolean);if(s.length)return s.indexOf(n)>=0?n:s[0]}}return n}var f={built:!1,visible:!1,activeInstance:null,_bodyOverflow:null,$el:null,$shell:null,$title:null,$counter:null,$stageWrap:null,$stage:null,$loader:null,$prev:null,$next:null,$footer:null,$pollOption:null,$footerRow:null,$toolbar:null,$zoomWidget:null,$zoomSlider:null,$zoomPct:null,_zoom:1,_panX:0,_panY:0,_isPanning:!1,_panOriginX:0,_panOriginY:0,_panStartX:0,_panStartY:0,_pinchStartDist:0,_pinchStartZoom:1,_pinchMidX:0,_pinchMidY:0,_pinchPanStartX:0,_pinchPanStartY:0,_justEndedPinch:!1,_isImageItem:!1,_isCustomRendered:!1,_swipeStartX:0,_swipeStartY:0,_swipeEndX:0,_swipeEndY:0,_swipeTracking:!1,ensure:function(){if(!this.built){var e='<div class="cv-overlay"><div class="cv-backdrop" aria-hidden="true"></div><div class="cv-shell" id="cv-dialog"><div class="cv-header"><div class="cv-header-left"><span class="cv-counter" id="cv-dialog-desc"></span></div><div class="cv-header-center"><span class="cv-title" id="cv-dialog-title"></span></div><div class="cv-header-right"><button class="cv-carousel-toggle" type="button" style="display:none">'+r.thumbnails+'</button><button class="cv-fullscreen-toggle" type="button" style="display:none">'+r.fullscreen+'</button><button class="cv-theme-toggle" type="button">'+r.themeLight+'</button><button class="cv-close" type="button">'+r.close+'</button></div></div><div class="cv-body"><button class="cv-nav cv-nav-prev" type="button"><span class="cv-nav-icon">'+r.prev+'</span></button><div class="cv-stage-wrap"><div class="cv-loader"><div class="cv-spinner"></div></div><div class="cv-stage"></div></div><button class="cv-nav cv-nav-next" type="button"><span class="cv-nav-icon">'+r.next+'</span></button></div><div class="cv-carousel-wrap"><button class="cv-carousel-nav cv-carousel-prev" type="button">'+r.prev+'</button><div class="cv-carousel-inner"><div class="cv-carousel"></div></div><button class="cv-carousel-nav cv-carousel-next" type="button">'+r.next+'</button></div><div class="cv-footer"><div class="cv-slideshow-progress-wrap"><div class="cv-slideshow-progress-bar"></div></div><div class="cv-poll-option"></div><div class="cv-footer-row"><div class="cv-toolbar"></div><div class="cv-zoom-widget"><button class="cv-tb-btn cv-zoom-out-btn" type="button">'+r.zoomOut+'</button><input type="range" class="cv-zoom-slider" min="1" max="5" step="0.01" value="1" /><button class="cv-tb-btn cv-zoom-in-btn" type="button">'+r.zoomIn+'</button><span class="cv-zoom-pct">100%</span></div></div></div></div></div>';t("body").append(e),t("#cv-tooltip").length||t("body").append('<div class="cv-tooltip" id="cv-tooltip" aria-hidden="true"></div>'),this.$el=t(".cv-overlay").last(),this.$backdrop=this.$el.find(".cv-backdrop"),this.$shell=this.$el.find(".cv-shell"),this.$title=this.$el.find(".cv-title"),this.$counter=this.$el.find(".cv-counter"),this.$themeToggle=this.$el.find(".cv-theme-toggle"),this.$fullscreenToggle=this.$el.find(".cv-fullscreen-toggle"),this.$stageWrap=this.$el.find(".cv-stage-wrap"),this.$stage=this.$el.find(".cv-stage"),this.$loader=this.$el.find(".cv-loader"),this.$prev=this.$el.find(".cv-nav-prev"),this.$next=this.$el.find(".cv-nav-next"),this.$carouselWrap=this.$el.find(".cv-carousel-wrap"),this.$carousel=this.$el.find(".cv-carousel"),this.$carouselToggle=this.$el.find(".cv-carousel-toggle"),this.$carouselPrev=this.$el.find(".cv-carousel-prev"),this.$carouselNext=this.$el.find(".cv-carousel-next"),this.$footer=this.$el.find(".cv-footer"),this.$pollOption=this.$el.find(".cv-poll-option"),this.$footerRow=this.$el.find(".cv-footer-row"),this.$toolbar=this.$el.find(".cv-toolbar"),this.$zoomWidget=this.$el.find(".cv-zoom-widget"),this.$zoomSlider=this.$el.find(".cv-zoom-slider"),this.$zoomPct=this.$el.find(".cv-zoom-pct"),this.$slideshowProgressWrap=this.$el.find(".cv-slideshow-progress-wrap"),this.$slideshowProgressBar=this.$el.find(".cv-slideshow-progress-bar"),this.$tooltip=t("#cv-tooltip"),this.$zoomPct.hide(),this._bindEvents(),this._bindTooltip(),this.built=!0}},_bindEvents:function(){var n=this;this.$el.find(".cv-close").on("click",function(){n.close()}),this.$themeToggle.on("click",function(t){if(t.preventDefault(),t.stopPropagation(),n.activeInstance){var e=n.activeInstance,i="dark"===(e.opts.theme||"dark")?"light":"dark";return e.opts.theme=i,n.$el[0].className="cv-overlay cv-visible cv-theme-"+i,n._syncThemeToggle(),"function"==typeof e.opts.onThemeChange&&e.opts.onThemeChange(i,e),!1}}),this.$carouselToggle.on("click",function(t){t.preventDefault(),n.activeInstance&&(n._carouselOpen=!n._carouselOpen,n._carouselOpen?n.$carouselWrap.addClass("cv-open"):n.$carouselWrap.removeClass("cv-open"),n.$carouselToggle.attr("aria-expanded",n._carouselOpen),n._updateCarouselNavVisibility(n.activeInstance))}),this.$fullscreenToggle.on("click",function(t){t.preventDefault(),n.activeInstance&&n._toggleOverlayFullscreen()}),this.$carouselPrev.on("click",function(t){t.preventDefault();var e=n.$carousel[0];e&&(e.scrollLeft-=570)}),this.$carouselNext.on("click",function(t){t.preventDefault();var e=n.$carousel[0];e&&(e.scrollLeft+=570)}),this.$prev.on("click",function(){n._nav("prev")}),this.$next.on("click",function(){n._nav("next")}),this.$backdrop[0].addEventListener("click",function(t){t.target===n.$backdrop[0]&&n.activeInstance&&n.activeInstance.opts.overlayClose&&n.close()}),t(i).on("fullscreenchange.cv-overlay-fullscreen webkitfullscreenchange.cv-overlay-fullscreen mozfullscreenchange.cv-overlay-fullscreen msfullscreenchange.cv-overlay-fullscreen",function(){setTimeout(function(){n.$fullscreenToggle.length&&n.$fullscreenToggle.is(":visible")&&n._syncFullscreenToggle()},0)}),t(i).on("keydown.cv-overlay",function(t){if(n.visible&&n.activeInstance&&n.activeInstance.opts.keyboardNav){if("Escape"===t.key)return i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement?(i.exitFullscreen?i.exitFullscreen():i.webkitExitFullscreen?i.webkitExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.msExitFullscreen&&i.msExitFullscreen(),setTimeout(function(){n._syncFullscreenToggle()},0),void t.preventDefault()):void n.close();if("ArrowLeft"!==t.key)if("ArrowRight"!==t.key){var o=t.target&&t.target.tagName?t.target.tagName.toLowerCase():"";if(/(input|textarea|select)/.test(o)||!n._isImageItem||"+"!==t.key&&"="!==t.key&&"-"!==t.key){if("Tab"===t.key&&n.activeInstance.opts.wcag){var s=n.$shell[0];if(!s)return;var l=s.querySelectorAll('button, [href], input:not([disabled]), select, textarea, [tabindex]:not([tabindex="-1"])'),a=[].slice.call(l).filter(function(t){var i=e.getComputedStyle(t);return"none"!==i.display&&"hidden"!==i.visibility&&(null!==t.offsetParent||t.getBoundingClientRect().width>0)});if(0===a.length)return;var r=s.contains(t.target),c=a.indexOf(t.target);if(!r||-1===c)return t.preventDefault(),void a[0].focus();t.shiftKey?0===c&&(t.preventDefault(),a[a.length-1].focus()):c===a.length-1&&(t.preventDefault(),a[0].focus())}}else{t.preventDefault();var d=n._zoomOpts(),u=null!=d.wheelStep?d.wheelStep:.25;"-"===t.key?n._setZoom(Math.max(d.min,n._zoom-u)):n._setZoom(Math.min(d.max,n._zoom+u))}}else n._nav("next");else n._nav("prev")}}),this.$zoomSlider.on("input",function(){if(n._isImageItem){var t=parseFloat(this.value);if(0!==n._zoom){var e=t/n._zoom;n._panX*=e,n._panY*=e}n._zoom=t,n._clampPan(),n._applyTransform(),n._fireZoom()}}),this.$el.find(".cv-zoom-out-btn").on("click",function(){n._isImageItem&&n._setZoom(Math.max(n._zoomOpts().min,n._zoom-.25))}),this.$el.find(".cv-zoom-in-btn").on("click",function(){n._isImageItem&&n._setZoom(Math.min(n._zoomOpts().max,n._zoom+.25))}),this.$zoomPct.on("click",function(){n._isImageItem&&n._setZoom(1)}),this.$stageWrap.on("dblclick",function(t){n._isImageItem&&(t.preventDefault(),n._setZoom(1))}),this.$stageWrap[0].addEventListener("wheel",function(t){if(n.visible&&n._isImageItem){t.preventDefault();var e=n._zoomOpts(),i=t.deltaY<0?e.wheelStep:-e.wheelStep,o=Math.max(e.min,Math.min(e.max,n._zoom+i));if(o!==n._zoom){if(n._isGifItem())n._panX=0,n._panY=0;else{var s=n.$stageWrap[0].getBoundingClientRect(),l=t.clientX-s.left-s.width/2,a=t.clientY-s.top-s.height/2,r=o/n._zoom;n._panX=l-r*(l-n._panX),n._panY=a-r*(a-n._panY)}n._zoom=o,n._clampPan(),n._syncSlider(),n._applyTransform()}}},{passive:!1}),this.$stageWrap.on("mousedown",function(t){!n._isImageItem||n._zoom<=1||0!==t.button||n._isGifItem()||(t.preventDefault(),n._isPanning=!0,n._panOriginX=t.clientX,n._panOriginY=t.clientY,n._panStartX=n._panX,n._panStartY=n._panY)}),t(i).on("mousemove.cv-pan",function(t){n._isPanning&&(n._panX=n._panStartX+(t.clientX-n._panOriginX),n._panY=n._panStartY+(t.clientY-n._panOriginY),n._clampPan(),n._applyTransform())}),t(i).on("mouseup.cv-pan",function(){n._isPanning=!1}),this.$stageWrap.on("touchstart",function(t){if(n._isImageItem){var e=t.originalEvent.touches;2===e.length?(t.preventDefault(),n._isPanning=!1,n._pinchStartDist=n._touchDist(e),n._pinchStartZoom=n._zoom,n._pinchMidX=(e[0].clientX+e[1].clientX)/2,n._pinchMidY=(e[0].clientY+e[1].clientY)/2,n._pinchPanStartX=n._panX,n._pinchPanStartY=n._panY):1===e.length&&n._zoom>1&&!n._isGifItem()&&(n._isPanning=!0,n._panOriginX=e[0].clientX,n._panOriginY=e[0].clientY,n._panStartX=n._panX,n._panStartY=n._panY)}}),this.$stageWrap.on("touchmove",function(t){if(n._isImageItem){var e=t.originalEvent.touches;if(2===e.length&&n._pinchStartDist){t.preventDefault(),n._justEndedPinch=!1;var i=n._zoomOpts(),o=n._touchDist(e),s=Math.max(i.min,Math.min(i.max,n._pinchStartZoom*(o/n._pinchStartDist)));if(n._isGifItem())n._panX=0,n._panY=0;else{var l=(e[0].clientX+e[1].clientX)/2,a=(e[0].clientY+e[1].clientY)/2,r=n.$stageWrap[0].getBoundingClientRect(),c=l-r.left-r.width/2,d=a-r.top-r.height/2,u=s/n._zoom;n._panX=c-u*(c-n._panX),n._panY=d-u*(d-n._panY)}n._zoom=s,n._clampPan(),n._syncSlider(),n._applyTransform()}else 1===e.length&&n._isPanning&&(n._justEndedPinch&&(n._panOriginX=e[0].clientX,n._panOriginY=e[0].clientY,n._panStartX=n._panX,n._panStartY=n._panY,n._justEndedPinch=!1),n._panX=n._panStartX+(e[0].clientX-n._panOriginX),n._panY=n._panStartY+(e[0].clientY-n._panOriginY),n._clampPan(),n._applyTransform())}}),this.$stageWrap.on("touchend touchcancel",function(t){var e=t.originalEvent.touches;if(1===e.length&&n._zoom>1&&!n._isGifItem()?(n._isPanning=!0,n._justEndedPinch=n._pinchStartDist>0,n._panOriginX=e[0].clientX,n._panOriginY=e[0].clientY,n._panStartX=n._panX,n._panStartY=n._panY):0===e.length&&(n._isPanning=!1,n._justEndedPinch=!1),n._pinchStartDist=0,n._swipeTracking&&0===e.length){var i=n._swipeEndX-n._swipeStartX,o=n._swipeEndY-n._swipeStartY,s=n.activeInstance;s&&s.opts.overlayClose&&!1!==s.opts.swipeToClose&&o>=60&&o>Math.abs(i)?(t.preventDefault(),n.close()):s&&s.items.length>1&&!1!==s.opts.swipeNav&&!(n._isImageItem&&n._zoom>1)&&Math.abs(i)>=50&&Math.abs(i)>Math.abs(o)&&(t.preventDefault(),n._nav(i>0?"prev":"next",!0)),n._swipeTracking=!1}}),this.$stageWrap.on("touchstart",function(t){var e=t.originalEvent.touches;if(1===e.length&&n.activeInstance){var i=n.activeInstance,o=i.items.length>1&&!1!==i.opts.swipeNav&&!(n._isImageItem&&n._zoom>1),s=i.opts.overlayClose&&!1!==i.opts.swipeToClose;(o||s)&&(n._swipeStartX=e[0].clientX,n._swipeStartY=e[0].clientY,n._swipeEndX=n._swipeStartX,n._swipeEndY=n._swipeStartY,n._swipeTracking=!0)}}),this.$stageWrap.on("touchmove",function(t){n._swipeTracking&&1===t.originalEvent.touches.length&&(n._swipeEndX=t.originalEvent.touches[0].clientX,n._swipeEndY=t.originalEvent.touches[0].clientY)})},_bindTooltip:function(){var e,i=this.$tooltip;i.length&&(this.$el.on("mouseenter.cv-tooltip","[data-cv-tooltip]",function(n){!function(t){var n=t.attr("data-cv-tooltip");if(n){clearTimeout(e),i.text(n).attr("aria-hidden","false").addClass("cv-tooltip-visible");var o=t[0].getBoundingClientRect(),s=i[0].getBoundingClientRect(),l=o.left+o.width/2-s.width/2,a=o.top-s.height-6;a<8&&(a=o.bottom+6),i.css({left:l+"px",top:a+"px"})}}(t(n.currentTarget))}),this.$el.on("mouseleave.cv-tooltip","[data-cv-tooltip]",function(t){n()}),this.$el.on("mouseenter.cv-tooltip",".cv-tooltip",function(){clearTimeout(e)}),this.$el.on("mouseleave.cv-tooltip",".cv-tooltip",n));function n(){e=setTimeout(function(){i.removeClass("cv-tooltip-visible").attr("aria-hidden","true")},50)}},_applyTooltips:function(t){if(t&&this.$el.length){var e=!1!==t.opts.canShowTooltip,n=function(t,i){if(e){var n=a(0,i);t.attr("data-cv-tooltip",n)}else t.removeAttr("data-cv-tooltip")};n(this.$el.find(".cv-close"),"close"),n(this.$carouselToggle,"attachments");var o=i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement;n(this.$fullscreenToggle,o===this.$el[0]?"exitFullscreen":"fullscreen"),n(this.$themeToggle,"dark"===(t.opts.theme||"dark")?"switchToLightMode":"switchToDarkMode"),n(this.$prev,"previousItem"),n(this.$next,"nextItem"),n(this.$carouselPrev,"scrollCarouselLeft"),n(this.$carouselNext,"scrollCarouselRight"),n(this.$el.find(".cv-zoom-out-btn"),"zoomOut"),n(this.$zoomSlider,"zoomLevel"),n(this.$el.find(".cv-zoom-in-btn"),"zoomIn")}},_nav:function(t,e){if(this.activeInstance){var i=e?{transition:!0}:void 0;"prev"===t?this.activeInstance.prev(i):this.activeInstance.next(i)}},_zoomOpts:function(){return this.activeInstance&&this.activeInstance.opts.zoom||s.zoom},_isGifItem:function(){var t=this.activeInstance;if(!t||!t.items||t.idx<0)return!1;var e=t.items[t.idx];return"image"===(e.type||"image")&&e.src&&/\.gif$/i.test(e.src)},_setZoom:function(t){var e=this._zoomOpts(),i=Math.max(e.min,Math.min(e.max,t));if(i!==this._zoom){var n=i/this._zoom;this._panX*=n,this._panY*=n}this._zoom=i,this._clampPan(),this._syncSlider(),this._applyTransform()},_syncSlider:function(){var t=Number(this._zoom);this.$zoomSlider.val(t);var e=Math.round(100*t);this.$zoomPct.text(e+"%"),this._fireZoom()},_fireZoom:function(){var t=this.activeInstance;if(t){var e=t.opts.zoom&&t.opts.zoom.onZoom;"function"==typeof e&&e(this._zoom,t.items[t.idx],t)}},_applyTransform:function(){var t=this.$stage.find(".cv-image");t.length&&(t.css("transform","translate(-50%, -50%) translate("+this._panX+"px,"+this._panY+"px) scale("+this._zoom+")"),t.css("cursor",this._zoom>1&&!this._isGifItem()?"grab":""))},_clampPan:function(){if(this._isGifItem())return this._panX=0,void(this._panY=0);if(this._zoom<=1)return this._panX=0,void(this._panY=0);var t=this.$stageWrap[0],e=this.$stage.find(".cv-image")[0];if(t){var i,n,o=t.clientWidth,s=t.clientHeight;if(e&&(e.naturalWidth||e.offsetWidth)&&(e.naturalHeight||e.offsetHeight)){var l=e.naturalWidth||e.offsetWidth,a=e.naturalHeight||e.offsetHeight,r=Math.min(o/l,s/a),c=l*r,d=a*r;i=Math.max(0,(c*this._zoom-o)/2),n=Math.max(0,(d*this._zoom-s)/2)}else i=Math.max(0,(this._zoom-1)*o/2),n=Math.max(0,(this._zoom-1)*s/2);this._panX=Math.max(-i,Math.min(i,this._panX)),this._panY=Math.max(-n,Math.min(n,this._panY))}},_resetZoomPan:function(){this._zoom=1,this._panX=0,this._panY=0,this._isPanning=!1,this._pinchStartDist=0,this._justEndedPinch=!1,this._syncSlider()},_touchDist:function(t){var e=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(e*e+i*i)},open:function(t){this.ensure(),this.activeInstance=t,this._swipeTracking=!1,t.opts.wcag?(this._focusBeforeOpen=i.activeElement,this.$el[0].setAttribute("aria-hidden","false"),this.$shell[0].setAttribute("role","dialog"),this.$shell[0].setAttribute("aria-modal","true"),this.$shell[0].setAttribute("aria-labelledby","cv-dialog-title"),this.$shell[0].setAttribute("aria-describedby","cv-dialog-desc"),this.$title[0].setAttribute("aria-live","polite"),this.$counter[0].setAttribute("aria-live","polite"),this.$el.find(".cv-close").attr("aria-label",a(0,"close")),this.$el.find(".cv-carousel-toggle").attr("aria-label",a(0,"attachments")),this.$el.find(".cv-nav-prev").attr("aria-label",a(0,"previousItem")),this.$el.find(".cv-nav-next").attr("aria-label",a(0,"nextItem")),this.$el.find(".cv-zoom-out-btn").attr("aria-label",a(0,"zoomOut")),this.$el.find(".cv-zoom-slider").attr("aria-label",a(0,"zoomLevel")),this.$el.find(".cv-zoom-in-btn").attr("aria-label",a(0,"zoomIn")),this.$carouselPrev.attr("aria-label",a(0,"scrollCarouselLeft")),this.$carouselNext.attr("aria-label",a(0,"scrollCarouselRight"))):(this.$el[0].removeAttribute("aria-hidden"),this.$shell[0].removeAttribute("role"),this.$shell[0].removeAttribute("aria-modal"),this.$shell[0].removeAttribute("aria-labelledby"),this.$shell[0].removeAttribute("aria-describedby"),this.$title[0].removeAttribute("aria-live"),this.$counter[0].removeAttribute("aria-live"),this.$el.find(".cv-close, .cv-carousel-toggle, .cv-nav-prev, .cv-nav-next, .cv-zoom-out-btn, .cv-zoom-slider, .cv-zoom-in-btn").removeAttr("aria-label"),this.$carouselPrev.add(this.$carouselNext).removeAttr("aria-label"),this.$themeToggle.removeAttr("aria-label"),this.$fullscreenToggle.removeAttr("aria-label"));var e=t.opts.theme||"dark";this.$el[0].className="cv-overlay cv-theme-"+e,this.$themeToggle.toggle(!1!==t.opts.themeToggle),this._syncThemeToggle();var n=t.opts.zoom||s.zoom;if(this.$zoomSlider.attr({min:n.min,max:n.max,step:n.step}),this._updateNavButtons(t),this._carouselOpen=!1,this._carouselEnabled(t)&&t.items.length>0?(this.$carouselToggle.show(),this._buildCarousel(t),this.$carouselWrap.removeClass("cv-open"),this.$carouselToggle.attr("aria-expanded","false"),this._updateCarouselNavVisibility(t)):(this.$carouselToggle.hide(),this.$carouselWrap.removeClass("cv-open")),this.$fullscreenToggle.toggle(!1!==t.opts.fullscreen),this._syncFullscreenToggle(),this._applyTooltips(t),this._stageOnlyEnabled(t)?this.$shell.addClass("cv-stage-only"):this.$shell.removeClass("cv-stage-only"),this._stageOnlyEnabled(t)&&t.opts.slideshow&&t.opts.slideshow.enabled&&t.items.length>1?this.$shell.addClass("cv-slideshow-visible"):this.$shell.removeClass("cv-slideshow-visible"),this.$el.addClass("cv-visible"),this.visible=!0,this._bodyOverflow=i.body.style.overflow,i.body.style.overflow="hidden",this.loadItem(),t.opts.wcag){var o=this;setTimeout(function(){var e;(e=o._stageOnlyEnabled(t)&&!o._stageOnlyHideNav(t)?o.$prev.is(":visible")?o.$prev[0]:o.$next[0]:o._stageOnlyEnabled(t)?o.$el.find(".cv-close")[0]||o.$stage[0]:o.$el.find(".cv-close")[0])&&e.focus()},0)}},_updateNavButtons:function(t){return!t||t.items.length<=1||this._stageOnlyEnabled(t)&&this._stageOnlyHideNav(t)?(this.$prev.hide(),void this.$next.hide()):void(t.opts.loop?(this.$prev.show(),this.$next.show()):(this.$prev.toggle(t.idx>0),this.$next.toggle(t.idx<t.items.length-1)))},_preloadAdjacentImages:function(t){if(t&&t.items.length&&!1!==t.opts.preloadAdjacentImages){var e=t.items.length,i=t.opts.loop?(t.idx+1)%e:t.idx+1<e?t.idx+1:-1,n=t.opts.loop?(t.idx-1+e)%e:t.idx-1>=0?t.idx-1:-1,o=function(t){if(t&&"image"===(t.type||"image")){var e=t.src;if(e&&u(e))(new Image).src=e}};i>=0&&o(t.items[i]),n>=0&&n!==i&&o(t.items[n])}},_carouselEnabled:function(t){if(!t)return!1;var e=t.opts.carousel;return!(!e||!e.enabled)},_carouselNavThreshold:function(t){if(!t)return 4;var e=t.opts.carousel;return e&&null!=e.navThreshold?e.navThreshold:4},_stageOnlyEnabled:function(t){if(!t||!t.opts.stageOnly)return!1;var e=t.opts.stageOnly;return!0===e||e&&!0===e.enabled},_stageOnlyHideNav:function(t){return!(!t||!t.opts.stageOnly||"object"!=typeof t.opts.stageOnly)&&!0===t.opts.stageOnly.hideNavigation},_buildCarousel:function(e){var i=this;this.$carousel.empty();for(var n=e.items,o=function(t,e){if(null==t||""===t)return"";var i=String(t).trim();return i.length<=e?i:i.slice(0,e-1)+"…"},s=0;s<n.length;s++)(function(s){var l=n[s],c=l.type||"image",d=null;"image"===c&&l.src&&u(l.src)?d=l.thumbnailUrl&&u(l.thumbnailUrl)?l.thumbnailUrl:l.src:("video"===c||"audio"===c)&&l.thumbnailUrl&&u(l.thumbnailUrl)&&(d=l.thumbnailUrl);var p="pdf"===c?"PDF":"video"===c?"Video":"audio"===c?"Audio":"inline"===c?"Code":"html"===c?"HTML":"error"===c?"—":(l.fileExt||c).slice(0,4),h=null!=l.title&&""!==l.title?String(l.title).trim():"",v=t('<button type="button" class="cv-carousel-item" data-cv-index="'+s+'"></button>');if(d){var f=t('<img class="cv-carousel-thumb" alt="">').attr("src",d);f.on("error",function(){v.addClass("cv-carousel-no-thumb")}),v.append(f),"video"!==c&&"audio"!==c||v.append(t('<span class="cv-carousel-play-icon">'+r.play+"</span>"))}else v.addClass("cv-carousel-no-thumb").text(h?o(h,12):p);h&&v.attr("title",h),e.opts.wcag&&v.attr("aria-label",a(0,"carouselItemLabel").replace("%1",String(s+1)).replace("%2",String(e.items.length))),v.on("click",function(t){t.preventDefault(),e===i.activeInstance&&s!==e.idx&&e.goTo(s)}),i.$carousel.append(v)})(s);this._updateCarouselSelection(e),this._updateCarouselNavVisibility(e)},_updateCarouselNavVisibility:function(t){if(t&&this._carouselEnabled(t)){var e=this._carouselNavThreshold(t),i=t.items.length>e;this.$carouselPrev.toggle(i),this.$carouselNext.toggle(i)}},_updateCarouselSelection:function(t){if(t&&this._carouselEnabled(t)){this.$carousel.find(".cv-carousel-item").removeClass("cv-active").attr("aria-current",null);var e=this.$carousel.find('.cv-carousel-item[data-cv-index="'+t.idx+'"]');e.addClass("cv-active").attr("aria-current","true");var i=e[0];i&&i.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"})}},_syncThemeToggle:function(){var t=this.activeInstance;if(t){var e=t.opts.theme||"dark",i=a(0,"dark"===e?"switchToLightMode":"switchToDarkMode");t.opts.wcag&&this.$themeToggle.attr("aria-label",i),this.$themeToggle.html("dark"===e?r.themeLight:r.themeDark),this._applyTooltips(t)}},_syncFullscreenToggle:function(){var e=(i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement)===this.$el[0],n=this.activeInstance,o=n?a(0,e?"exitFullscreen":"fullscreen"):e?"Exit fullscreen":"Fullscreen";n&&n.opts.wcag&&this.$fullscreenToggle.attr("aria-label",o),this.$fullscreenToggle.html(e?r.fullscreenExit:r.fullscreen),n&&!1!==n.opts.canShowTooltip?this.$fullscreenToggle.attr("data-cv-tooltip",o):n&&this.$fullscreenToggle.removeAttr("data-cv-tooltip"),n&&this._applyTooltips(n),this.$tooltip&&this.$tooltip.length&&(e&&this.$tooltip.parent()[0]!==this.$el[0]?this.$el.append(this.$tooltip):e||this.$tooltip.parent()[0]===i.body||t("body").append(this.$tooltip))},_toggleOverlayFullscreen:function(){var t=this.$el[0],e=i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement,n=this;e&&e===t?(i.exitFullscreen?i.exitFullscreen():i.webkitExitFullscreen?i.webkitExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.msExitFullscreen&&i.msExitFullscreen(),setTimeout(function(){n._syncFullscreenToggle()},50)):(t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen(),setTimeout(function(){n._syncFullscreenToggle()},100))},close:function(){if(this.$tooltip&&this.$tooltip.length&&this.$tooltip.removeClass("cv-tooltip-visible").attr("aria-hidden","true"),this.activeInstance){var t=this.activeInstance,e=t.items[t.idx],n=t.opts.wcag;t._slideshowTimer&&(clearTimeout(t._slideshowTimer),t._slideshowTimer=null),(i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement)===this.$el[0]&&(i.exitFullscreen?i.exitFullscreen():i.webkitExitFullscreen?i.webkitExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.msExitFullscreen&&i.msExitFullscreen());var o=this;this.$el.addClass("cv-closing"),setTimeout(function(){o._destroyCurrent(t),"function"==typeof t.opts.onClose&&e&&t.opts.onClose(e,t),o.$el.removeClass("cv-visible cv-closing"),i.body.style.overflow=null!=o._bodyOverflow?o._bodyOverflow:"",o._bodyOverflow=null,n&&o.$el[0].setAttribute("aria-hidden","true"),n&&(o.$title[0]&&o.$title[0].removeAttribute("aria-live"),o.$counter[0]&&o.$counter[0].removeAttribute("aria-live")),o.$stage.empty(),o.$loader.removeClass("cv-active"),o._resetZoomPan(),o._swipeTracking=!1,o.visible=!1,o.activeInstance=null,n&&o._focusBeforeOpen&&"function"==typeof o._focusBeforeOpen.focus&&o._focusBeforeOpen.focus(),o._focusBeforeOpen=null},300)}else null!=this._bodyOverflow&&(i.body.style.overflow=this._bodyOverflow,this._bodyOverflow=null)},loadItem:function(t){var e=this.activeInstance;if(e&&e.items[e.idx]){if((t=t||{}).transition&&this.$stage.children().length>0){var i=this;return this.$stageWrap.addClass("cv-stage-out"),void setTimeout(function(){i.$stageWrap.removeClass("cv-stage-out"),i._loadItemCore(e,!0)},280)}this._loadItemCore(e,!1)}},_loadItemCore:function(n,s){var l=n.items[n.idx];if(l){"function"==typeof n.opts.onLoading&&n.opts.onLoading(l,n),this._destroyCurrent(n),this.$stage.empty(),this.$loader.removeClass("cv-active"),this._resetZoomPan(),this.$title.text(null!=l.title&&""!==l.title?String(l.title):""),this.$counter.text(n.idx+1+" / "+n.items.length);var h=l.type||"image";if("html"===h){var g=null!=l.title&&""!==l.title;this.$title.closest(".cv-header-center").toggle(g),this.$counter.closest(".cv-header-left").toggle(g)}else this.$title.closest(".cv-header-center").show(),this.$counter.closest(".cv-header-left").show();!1===n.opts.showCounter&&this.$counter.closest(".cv-header-left").hide();var b=null;this._isCustomRendered=!1,this._isImageItem=!1,this._isHtmlItem=!1,"function"==typeof n.opts.onRender&&(b=n.opts.onRender(l,this.$stage,n),this.$stage.children().length>0&&(this._isCustomRendered=!0)),this._isCustomRendered||(this._isImageItem="image"===h,this._isHtmlItem="html"===h,"image"===h?b=function(e,i){if(!e.src||!u(e.src))return m(i,"Invalid or unsafe image URL",e,{noDownload:!0}),{imageError:!0};var n=f.activeInstance,o=(e.downloadUrl||e.src)&&p(e.downloadUrl||e.src),s=t('<div class="cv-img-wrap"></div>');f.$loader.addClass("cv-active");var l=null!=e.title&&""!==String(e.title).trim()?String(e.title):"",a=t('<img class="cv-image" alt="'+c(l)+'" />'),r=new Image;return r.onload=function(){f.$loader.removeClass("cv-active"),a.attr("src",e.src).attr("alt",l).addClass("cv-loaded"),f._clampPan(),f._applyTransform()},r.onerror=function(){f.$loader.removeClass("cv-active"),s.remove(),i.empty(),m(i,"Image could not be loaded",e,{noDownload:!o}),n&&f._resolveToolbar(n,{imageError:!0})},r.src=e.src,s.append(a),i.append(s),{}}(l,this.$stage):"video"===h?b=function(e,n,s){if(void 0===t.fn.jPlayer)return function(e,i){if(!u(e.src))return null;var n=t('<div class="cv-video-wrap"></div>'),o=e.thumbnailUrl&&u(e.thumbnailUrl)?e.thumbnailUrl:"",s=t('<video class="cv-native-video" controls playsinline preload="metadata"></video>');s.attr("src",e.src),o&&s.attr("poster",o);return n.append(s),i.append(n),{}}(e,n);if(!u(e.src))return null;var l="cv-jp-v-"+ ++o,r=l+"-ui",d=v(e,s),p={};p[d]=e.src,e.thumbnailUrl&&u(e.thumbnailUrl)&&(p.poster=e.thumbnailUrl);var h=s&&!1!==s.opts.canShowTooltip,m=function(t){return h?' data-cv-tooltip="'+c(a(0,t))+'"':""},g=t('<div class="cv-video-wrap"><div id="'+l+'" class="cv-jp-player"></div><div id="'+r+'" class="cv-jp-video-ui"><div class="cv-jp-video-screen"></div><div class="cv-jp-big-play"><svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21"/></svg></div><div class="cv-jp-controls"><button class="cv-jp-btn jp-play" type="button"'+m("play")+'><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21"/></svg></button><button class="cv-jp-btn jp-pause" type="button"'+m("pause")+' style="display:none"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg></button><span class="cv-jp-time jp-current-time">0:00</span><div class="cv-jp-progress jp-seek-bar"><div class="cv-jp-play-bar jp-play-bar"></div></div><span class="cv-jp-time jp-duration">0:00</span><select class="cv-jp-speed"'+m("playbackSpeed")+'><option value="0.5">0.5x</option><option value="0.75">0.75x</option><option value="1" selected>1x</option><option value="1.25">1.25x</option><option value="1.5">1.5x</option><option value="2">2x</option></select><button class="cv-jp-btn jp-mute" type="button"'+m("mute")+'><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg></button><button class="cv-jp-btn jp-unmute" type="button"'+m("unmute")+' style="display:none"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg></button><div class="cv-jp-volume jp-volume-bar"><div class="cv-jp-volume-val jp-volume-bar-value"></div></div><button class="cv-jp-btn jp-full-screen" type="button"'+m("fullscreen")+'><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" y1="3" x2="14" y2="10"/><line x1="3" y1="21" x2="10" y2="14"/></svg></button><button class="cv-jp-btn jp-restore-screen" type="button"'+m("exitFullscreen")+' style="display:none"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" y1="10" x2="21" y2="3"/><line x1="3" y1="21" x2="10" y2="14"/></svg></button></div></div></div>');n.append(g),s&&s.opts.wcag&&(g.find(".jp-play").attr("aria-label",a(0,"play")),g.find(".jp-pause").attr("aria-label",a(0,"pause")),g.find(".cv-jp-speed").attr("aria-label",a(0,"playbackSpeed")),g.find(".jp-mute").attr("aria-label",a(0,"mute")),g.find(".jp-unmute").attr("aria-label",a(0,"unmute")),g.find(".jp-full-screen").attr("aria-label",a(0,"fullscreen")),g.find(".jp-restore-screen").attr("aria-label",a(0,"exitFullscreen")));var b=g.find("#"+l),w=g.find(".cv-jp-big-play"),_=g.find(".cv-jp-video-screen"),y=g.find(".cv-jp-speed"),x=!1;function $(){x?b.jPlayer("pause"):b.jPlayer("play")}w.on("click",$),_.on("click",$),y.on("change",function(){b.jPlayer("option","playbackRate",parseFloat(this.value))});var k=g.find(".jp-full-screen"),T=g.find(".jp-restore-screen"),C=g[0];function S(){var e=i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement,n=e===C;if(k.toggle(!n),T.toggle(n),s&&!1!==s.opts.canShowTooltip&&(k.attr("data-cv-tooltip",a(0,"fullscreen")),T.attr("data-cv-tooltip",a(0,"exitFullscreen"))),s&&s.opts.wcag&&(k.attr("aria-label",a(0,"fullscreen")),T.attr("aria-label",a(0,"exitFullscreen"))),f.$tooltip&&f.$tooltip.length)if(n)f.$tooltip.parent()[0]!==C&&g.append(f.$tooltip);else{var o=f.$el&&f.$el[0];e===o?f.$tooltip.parent()[0]!==o&&f.$el.append(f.$tooltip):f.$tooltip.parent()[0]!==i.body&&t("body").append(f.$tooltip)}}return k.on("click",function(){C.requestFullscreen?C.requestFullscreen():C.webkitRequestFullscreen?C.webkitRequestFullscreen():C.mozRequestFullScreen?C.mozRequestFullScreen():C.msRequestFullscreen&&C.msRequestFullscreen()}),T.on("click",function(){i.exitFullscreen?i.exitFullscreen():i.webkitExitFullscreen?i.webkitExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.msExitFullscreen&&i.msExitFullscreen()}),t(i).on("fullscreenchange webkitfullscreenchange mozfullscreenchange msfullscreenchange.cv-video",function(){S()}),S(),b.jPlayer({ready:function(){t(this).jPlayer("setMedia",p)},play:function(){x=!0,w.addClass("cv-hidden")},pause:function(){x=!1,w.removeClass("cv-hidden")},ended:function(){x=!1,w.removeClass("cv-hidden")},supplied:d,cssSelectorAncestor:"#"+r,size:{width:"100%",height:"100%",cssClass:"cv-jp-video-size"},sizeFull:{width:"100%",height:"100%",cssClass:"cv-jp-video-size-full"},smoothPlayBar:!0,keyEnabled:!1,globalVolume:!0,playbackRate:1}),{destroy:function(){t(i).off("fullscreenchange webkitfullscreenchange mozfullscreenchange msfullscreenchange.cv-video"),b.jPlayer("destroy")}}}(l,this.$stage,n):"audio"===h?b=function(e,i,n){if(void 0===t.fn.jPlayer)return function(e,i){if(!u(e.src))return null;var n=(e.fileExt||e.title||"").split(".").pop().toUpperCase()||"AUDIO",o=t('<div class="cv-audio-wrap"><div class="cv-audio-artwork"><div class="cv-audio-icon"><svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" opacity=".4"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg></div><div class="cv-audio-title">'+c(e.title||"Audio")+'</div><div class="cv-audio-meta"><span>'+c(n)+'</span></div></div><div class="cv-audio-native-controls"></div></div>'),s=t('<audio controls preload="metadata"></audio>');return s.attr("src",e.src),o.find(".cv-audio-native-controls").append(s),i.append(o),{}}(e,i);if(!u(e.src))return null;var s="cv-jp-a-"+ ++o,l=s+"-ui",r=v(e,n),d={};d[r]=e.src;var p=(e.fileExt||e.title||"").split(".").pop().toUpperCase()||"AUDIO",h=n&&!1!==n.opts.canShowTooltip,f=function(t){return h?' data-cv-tooltip="'+c(a(0,t))+'"':""},m=t('<div class="cv-audio-wrap"><div id="'+s+'" class="cv-jp-player"></div><div class="cv-audio-artwork"><div class="cv-audio-icon"><svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" opacity=".4"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg></div><div class="cv-audio-title">'+c(e.title||"Audio")+'</div><div class="cv-audio-meta">'+(e.fileSize?"<span>"+c(e.fileSize)+"</span>":"")+"<span>"+c(p)+'</span></div></div><div id="'+l+'" class="cv-jp-audio-ui"><div class="cv-jp-controls"><button class="cv-jp-btn cv-jp-btn-lg jp-play" type="button"'+f("play")+'><svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21"/></svg></button><button class="cv-jp-btn cv-jp-btn-lg jp-pause" type="button"'+f("pause")+' style="display:none"><svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg></button><span class="cv-jp-time jp-current-time">0:00</span><div class="cv-jp-progress jp-seek-bar"><div class="cv-jp-play-bar jp-play-bar"></div></div><span class="cv-jp-time jp-duration">0:00</span><select class="cv-jp-speed"'+f("playbackSpeed")+'><option value="0.5">0.5x</option><option value="0.75">0.75x</option><option value="1" selected>1x</option><option value="1.25">1.25x</option><option value="1.5">1.5x</option><option value="2">2x</option></select><button class="cv-jp-btn jp-mute" type="button"'+f("mute")+'><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg></button><button class="cv-jp-btn jp-unmute" type="button"'+f("unmute")+' style="display:none"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg></button><div class="cv-jp-volume jp-volume-bar"><div class="cv-jp-volume-val jp-volume-bar-value"></div></div></div></div></div>');i.append(m),n&&n.opts.wcag&&(m.find(".jp-play").attr("aria-label",a(0,"play")),m.find(".jp-pause").attr("aria-label",a(0,"pause")),m.find(".cv-jp-speed").attr("aria-label",a(0,"playbackSpeed")),m.find(".jp-mute").attr("aria-label",a(0,"mute")),m.find(".jp-unmute").attr("aria-label",a(0,"unmute")));var g=m.find("#"+s);return m.find(".cv-jp-speed").on("change",function(){g.jPlayer("option","playbackRate",parseFloat(this.value))}),g.jPlayer({ready:function(){t(this).jPlayer("setMedia",d)},supplied:r,cssSelectorAncestor:"#"+l,smoothPlayBar:!0,keyEnabled:!1,globalVolume:!0,playbackRate:1}),{destroy:function(){g.jPlayer("destroy")}}}(l,this.$stage,n):"pdf"===h?b=function(n,o,s){if(void 0===e.pdfjsLib)return function(e,i){if(!u(e.src))return null;var n=t('<div class="cv-pdf-iframe-wrap"></div>'),o=t('<iframe class="cv-pdf-iframe" title="PDF"></iframe>');return o.attr("src",e.src),n.append(o),i.append(n),{}}(n,o);if(!u(n.src))return null;var l=s.opts.pdf||{},d=!1!==l.annotations,p=!1!==l.autoFit,h="number"==typeof l.autoFitMaxScale?l.autoFitMaxScale:2.5,v=t('<div class="cv-pdf-wrap"><div class="cv-pdf-sidebar" style="display:none"><div class="cv-pdf-thumbs"></div></div><div class="cv-pdf-main"><div class="cv-pdf-canvas-wrap"></div></div></div>'),g=v.find(".cv-pdf-sidebar"),b=v.find(".cv-pdf-thumbs"),w=v.find(".cv-pdf-main"),_=v.find(".cv-pdf-canvas-wrap"),y=null,x=1,$=0,k=1,T=0,C=!1,S=null,z=null;function I(){if(p&&y){var t=L();y.getPage(1).then(function(e){var i=e.getViewport({scale:1,rotation:T});t.w>0&&t.h>0&&(k=Math.max(.25,Math.min(t.w/i.width,t.h/i.height,h))),O()})}}function P(){if(y&&!($<1)){var t=w[0];if(t){for(var e=t.getBoundingClientRect(),i=_.find(".cv-pdf-page"),n=1,o=0,s=0;s<i.length;s++){var l=i[s],a=parseInt(l.getAttribute("data-page"),10);if(a){var r=l.getBoundingClientRect(),c=Math.max(e.top,r.top),d=Math.min(e.bottom,r.bottom),u=Math.max(0,d-c);u>o&&(o=u,n=a)}}x!==n&&(x=n,W&&W.text(x+" / "+$),b.find(".cv-pdf-thumb").removeClass("cv-active"),b.find('[data-page="'+x+'"]').addClass("cv-active"))}}}function j(e,n){y.getPage(e).then(function(o){var s=o.getViewport({scale:k,rotation:T}),l=t('<div class="cv-pdf-page"></div>');l.attr("data-page",e),l.css({position:"relative",width:s.width+"px",height:s.height+"px"});var a=i.createElement("canvas");a.width=s.width,a.height=s.height,a.className="cv-pdf-canvas",l.append(a),_.append(l);var r=o.render({canvasContext:a.getContext("2d"),viewport:s});(r.promise||r).then(function(){d&&F(o,s,l),n&&n()})})}function O(t){if(!C&&y){C=!0,_.empty();var e=0;i()}function i(){if(++e>$)return C=!1,W&&W.text(x+" / "+$),w.off("scroll.cv-pdf-page").on("scroll.cv-pdf-page",function(){clearTimeout(z),z=setTimeout(P,80)}),P(),void(t&&t());j(e,i)}}function E(t){if(!t||t.length<4)return[0,0,0,0];var e=t[0],i=t[1],n=t[2],o=t[3];return[Math.min(e,n),Math.min(i,o),Math.max(e,n),Math.max(i,o)]}function F(e,i,n){e.getAnnotations().then(function(e){if(e&&e.length){var o=i.convertToViewportRectangle||i.convertToViewport;if(o){var s=void 0!==pdfjsLib.Util&&"function"==typeof pdfjsLib.Util.normalizeRect?pdfjsLib.Util.normalizeRect:E,l=t('<div class="cv-pdf-annotations"></div>');l.css({position:"absolute",top:0,left:0,width:"100%",height:"100%"});for(var a=0;a<e.length;a++){var r=e[a];if(r.rect){var c=s(o.call(i,r.rect)),d=t('<div class="cv-pdf-annot"></div>');if(d.css({position:"absolute",left:c[0]+"px",top:c[1]+"px",width:c[2]-c[0]+"px",height:c[3]-c[1]+"px"}),"Link"===r.subtype&&r.url&&u(r.url)){var p=t('<a class="cv-pdf-annot-link"></a>');p.attr({href:r.url,target:"_blank"}),p.css({display:"block",width:"100%",height:"100%"}),d.append(p)}else"Link"===r.subtype&&r.dest&&function(t){d.css("cursor","pointer"),d.on("click",function(){"number"==typeof t?Y(t+1):Array.isArray(t)&&y.getPageIndex(t[0]).then(function(t){Y(t+1)})})}(r.dest);"Highlight"===r.subtype&&d.addClass("cv-pdf-annot-highlight"),l.append(d)}}n.append(l)}}})}function M(e){y.getPage(e).then(function(n){var o=n.getViewport({scale:.25}),s=i.createElement("canvas");s.width=o.width,s.height=o.height;var l=t('<div class="cv-pdf-thumb'+(1===e?" cv-active":"")+'" data-page="'+e+'"></div>');l.append(s).append('<span class="cv-pdf-thumb-num">'+e+"</span>"),l.on("click",function(){Y(e)}),b.append(l),n.render({canvasContext:s.getContext("2d"),viewport:o})})}function Y(t){if(!(t<1||t>$)){x=t,W&&W.text(x+" / "+$),b.find(".cv-pdf-thumb").removeClass("cv-active"),b.find('[data-page="'+x+'"]').addClass("cv-active");var e=_.find('.cv-pdf-page[data-page="'+t+'"]');e.length&&e[0].scrollIntoView({behavior:"smooth",block:"start"})}}f.$loader.addClass("cv-active"),l.workerSrc&&(pdfjsLib.GlobalWorkerOptions.workerSrc=l.workerSrc);var X={url:n.src};l.cMapUrl&&(X.cMapUrl=l.cMapUrl,X.cMapPacked=!1!==l.cMapPacked);function L(){var t=f.$stageWrap;return{w:(t&&t.length?t.width():0)||o.width()||600,h:(t&&t.length?t.height():0)||o.height()||800}}var A="object"==typeof X&&X.url?pdfjsLib.getDocument(X):pdfjsLib.getDocument(n.src);(A.promise||A).then(function(i){function n(){var n=L(),o=n.w,s=n.h;i.getPage(1).then(function(i){var n=i.getViewport({scale:1});k=p&&o>0&&s>0?Math.max(.25,Math.min(o/n.width,s/n.height,h)):!p&&o>0?Math.max(.25,Math.min(o/n.width,h)):Math.min(1,h),O(function(){for(var t=1;t<=$;t++)M(t)}),p&&t(e).on("resize.cv-pdf-autofit",function(){clearTimeout(S),S=setTimeout(I,150)})})}y=i,$=i.numPages,f.$loader.removeClass("cv-active"),requestAnimationFrame(function(){requestAnimationFrame(n)})},function(){f.$loader.removeClass("cv-active"),m(o,"PDF could not be loaded",n)}),o.append(v);var D=s&&!1!==s.opts.canShowTooltip?function(t){return' data-cv-tooltip="'+c(a(0,t))+'"'}:function(){return""},B=s&&s.opts.wcag?function(t){return' aria-label="'+c(a(0,t))+'"'}:function(){return""},R=[],N=t('<button class="cv-tb-btn"'+D("thumbnails")+B("thumbnails")+">"+r.thumbnails+"</button>");N.on("click",function(){g.toggle(),N.toggleClass("cv-active")}),R.push(N[0]);var U=t('<button class="cv-tb-btn"'+D("previousPage")+B("previousPage")+">"+r.prevPage+"</button>");U.on("click",function(){Y(x-1)}),R.push(U[0]);var W=t('<span class="cv-pdf-page-info">1 / -</span>');R.push(W[0]);var H=t('<button class="cv-tb-btn"'+D("nextPage")+B("nextPage")+">"+r.nextPage+"</button>");H.on("click",function(){Y(x+1)}),R.push(H[0]),R.push("separator");var V=t('<button class="cv-tb-btn"'+D("zoomOut")+B("zoomOut")+">"+r.zoomOut+"</button>");V.on("click",function(){k=Math.max(.25,k-.25),O()}),R.push(V[0]);var q=t('<button class="cv-tb-btn"'+D("zoomIn")+B("zoomIn")+">"+r.zoomIn+"</button>");q.on("click",function(){k=Math.min(5,k+.25),O()}),R.push(q[0]);var Z=t('<button class="cv-tb-btn"'+D("rotate")+B("rotate")+">"+r.rotateCw+"</button>");Z.on("click",function(){T=(T+90)%360,O()}),R.push(Z[0]);var G=t('<button class="cv-tb-btn"'+D("print")+B("print")+">"+r.print+"</button>");return G.on("click",function(){var t=_.find('.cv-pdf-page[data-page="'+x+'"]'),i=t.length?t.find("canvas")[0]:_.find("canvas")[0];if(i){var n=e.open(""),o=i.toDataURL().replace(/"/g,"&quot;");n.document.write('<img src="'+o+'" onload="window.print();window.close();" />')}}),R.push(G[0]),{toolbar:R,destroy:function(){clearTimeout(S),clearTimeout(z),t(e).off("resize.cv-pdf-autofit"),w.off("scroll.cv-pdf-page"),y&&y.destroy()}}}(l,this.$stage,n):"inline"===h?b=function(e,i){function n(t){for(var e=(null==t?"":String(t)).split(/\r\n|\n|\r/),i="",n=0;n<e.length;n++)i+='<div class="cv-inline-line"><span class="cv-inline-num">'+(n+1)+'</span><span class="cv-inline-code">'+c(e[n])+"</span></div>";return i}function o(e){var o=t('<div class="cv-inline-wrap"><div class="cv-inline-body">'+n(e)+"</div></div>");i.append(o)}if(null!=e.content&&"string"==typeof e.content)return o(e.content),{};if(e.src&&u(e.src)){var s=t('<div class="cv-inline-wrap"><div class="cv-inline-loading"><div class="cv-inline-spinner"></div></div></div>');return i.append(s),fetch(e.src,{method:"GET"}).then(function(t){return t.text()}).then(function(e){s.find(".cv-inline-loading").replaceWith(t('<div class="cv-inline-body">').html(n(e)))}).catch(function(){s.remove(),m(i,"Could not load file for inline view",e)}),{}}return m(i,"No content or invalid URL for inline view",e),null}(l,this.$stage):"error"===h?b=function(e,n){var o=null!=e.message&&""!==e.message?String(e.message):null!=e.errorMessage&&""!==e.errorMessage?String(e.errorMessage):"Preview is not available for this file",s=(e.fileExt||(e.title||"").split(".").pop()||"").toUpperCase(),l=e.fileSize||"",a=t('<div class="cv-unsupported"><div class="cv-unsupported-icon">'+r.fileIcon+"</div>"+(s?'<div class="cv-unsupported-ext">'+c(s)+"</div>":"")+'<div class="cv-unsupported-name">'+c(e.title||"File")+"</div>"+(l?'<div class="cv-unsupported-size">'+c(l)+"</div>":"")+'<p class="cv-unsupported-msg">'+c(o)+"</p>"+(e.src||e.downloadUrl?'<button class="cv-unsupported-dl" type="button">'+r.download+" Download</button>":"")+"</div>");return a.find(".cv-unsupported-dl").on("click",function(){var t=e.downloadUrl||e.src;if(t&&p(t)){var n=i.createElement("a");n.href=t,n.download=d(e.title),n.target="_blank",i.body.appendChild(n),n.click(),i.body.removeChild(n)}}),n.append(a),{}}(l,this.$stage):"html"===h&&(b=function(e,i){var n=e.html;if(null==n||"string"==typeof n&&""===String(n).trim())return m(i,"No HTML provided for html view",e),null;if(f.$loader.addClass("cv-active"),"string"==typeof n)i.append(t(n));else if(n.jquery)i.append(n);else{if(!n.nodeType)return f.$loader.removeClass("cv-active"),m(i,"No HTML provided for html view",e),null;i.append(n)}return setTimeout(function(){f.$loader.removeClass("cv-active")},120),{}}(l,this.$stage))),0===this.$stage.children().length&&function(e,n){var o=(e.fileExt||(e.title||"").split(".").pop()||"").toUpperCase(),s=e.fileSize||"",l=t('<div class="cv-unsupported"><div class="cv-unsupported-icon">'+r.fileIcon+"</div>"+(o?'<div class="cv-unsupported-ext">'+c(o)+"</div>":"")+'<div class="cv-unsupported-name">'+c(e.title||"File")+"</div>"+(s?'<div class="cv-unsupported-size">'+c(s)+"</div>":"")+'<p class="cv-unsupported-msg">Preview is not available for this file</p>'+(e.src||e.downloadUrl?'<button class="cv-unsupported-dl" type="button">'+r.download+" Download</button>":"")+"</div>");l.find(".cv-unsupported-dl").on("click",function(){var t=e.downloadUrl||e.src;if(t&&p(t)){var n=i.createElement("a");n.href=t,n.download=d(e.title),n.target="_blank",i.body.appendChild(n),n.click(),i.body.removeChild(n)}}),n.append(l)}(l,this.$stage),n._currentResult=b||{},this._resolveToolbar(n,b||{}),this._updatePollOption(n,l),!this.$pollOption.hasClass("cv-active")||b&&b.imageError||this.$footer.show(),this._updateNavButtons(n),this._preloadAdjacentImages(n),this._updateCarouselSelection(n),"function"==typeof n.opts.onOpen&&n.opts.onOpen(l,this.$stage,n),n._slideshowTimer&&(clearTimeout(n._slideshowTimer),n._slideshowTimer=null);var w=n.opts.slideshow;if(w&&w.enabled&&n.items.length>1&&!n._slideshowPaused&&(!1!==w.autoStart||n._slideshowPlaying)){var _=1e3*(null!=w.interval&&w.interval>0?w.interval:4),y="onEnd"===w.advanceMedia?"onEnd":"interval";if(n._slideshowPlaying=!0,"onEnd"===y){var x=this.$stage.find("video, audio");x.length?(x.one("ended",function(){n._slideshowTimer&&(clearTimeout(n._slideshowTimer),n._slideshowTimer=null),f.activeInstance===n&&n.next({transition:!0})}),n._slideshowTimer=setTimeout(function(){f.activeInstance===n&&n.next({transition:!0})},_)):n._slideshowTimer=setTimeout(function(){f.activeInstance===n&&n.next({transition:!0})},_)}else n._slideshowTimer=setTimeout(function(){f.activeInstance===n&&n.next({transition:!0})},_);w.showProgress&&this._startSlideshowProgress(_);var $=this.$toolbar.find(".cv-slideshow-btn");$.length&&($.find(".cv-tb-label").text(a(0,"pauseSlideshow")),!1!==n.opts.canShowTooltip&&$.attr("data-cv-tooltip",a(0,"pauseSlideshow")))}else this._stopSlideshowProgress();if(s&&this.$stage.children().length>0){var k=this;this.$stage.addClass("cv-stage-in"),requestAnimationFrame(function(){requestAnimationFrame(function(){k.$stage.addClass("cv-stage-in-visible"),setTimeout(function(){k.$stage.removeClass("cv-stage-in cv-stage-in-visible")},320)})})}}},_destroyCurrent:function(t){t._currentResult&&"function"==typeof t._currentResult.destroy&&t._currentResult.destroy(),t._currentResult=null},_startSlideshowProgress:function(t){if(this.$slideshowProgressWrap&&this.$slideshowProgressBar.length){this.$slideshowProgressBar.css({transition:"none",width:"0%"}),this.$slideshowProgressWrap.show();var e=this.$slideshowProgressBar[0];e&&e.offsetHeight,this.$slideshowProgressBar.css({transition:"width "+t+"ms linear",width:"100%"})}},_stopSlideshowProgress:function(){this.$slideshowProgressWrap&&this.$slideshowProgressBar.length&&(this.$slideshowProgressWrap.hide(),this.$slideshowProgressBar.css({transition:"none",width:"0%"}))},_slideshowButtonItem:function(t){var e=this,i=t.opts.slideshow;if(!i||!i.enabled||!t.items||t.items.length<2)return null;if(!0===i.autoStart&&!0===i.hideSlideshowButton)return null;var n=!t._slideshowPaused&&(!1!==i.autoStart||t._slideshowPlaying),o=1e3*(null!=i.interval&&i.interval>0?i.interval:4);return{id:"slideshow",className:"cv-slideshow-btn",showLabel:!0,label:a(0,n?"pauseSlideshow":"playSlideshow"),onClick:function(){var n=!t._slideshowPaused&&(!1!==i.autoStart||t._slideshowPlaying),s=e.$toolbar.find(".cv-slideshow-btn");n?(t._slideshowPaused=!0,t._slideshowTimer&&(clearTimeout(t._slideshowTimer),t._slideshowTimer=null),e._stopSlideshowProgress(),s.find(".cv-tb-label").text(a(0,"playSlideshow")),!1!==t.opts.canShowTooltip&&s.attr("data-cv-tooltip",a(0,"playSlideshow"))):(t._slideshowPaused=!1,t._slideshowPlaying=!0,t._slideshowTimer=setTimeout(function(){f.activeInstance===t&&t.next({transition:!0})},o),i.showProgress&&e._startSlideshowProgress(o),s.find(".cv-tb-label").text(a(0,"pauseSlideshow")),!1!==t.opts.canShowTooltip&&s.attr("data-cv-tooltip",a(0,"pauseSlideshow")))}}},_resolveToolbar:function(e,i){if(this._isHtmlItem)return this.$zoomWidget.hide(),this.$zoomPct.hide(),void((c=this._slideshowButtonItem(e))?(this._buildToolbar(e,[c],!1),this.$footer.show()):(this._buildToolbar(e,[],!1),this.$footer.hide()));if(i&&i.imageError)return this.$zoomWidget.hide(),this.$zoomPct.hide(),this._buildToolbar(e,[],!1),void this.$footer.hide();if(this._stageOnlyEnabled(e)&&(c=this._slideshowButtonItem(e)))return this.$zoomWidget.hide(),this.$zoomPct.hide(),this._buildToolbar(e,[c],!1),void this.$footer.show();if(this._stageOnlyEnabled(e))return this.$zoomWidget.hide(),this.$zoomPct.hide(),this._buildToolbar(e,[],!1),void this.$footer.hide();var n=e.opts.toolbar||{},o=this._isImageItem&&!this._isCustomRendered&&!1!==n.zoom,s=!!(e.opts.zoom||{}).showPercentage;if(this.$zoomWidget.toggle(o),this.$zoomPct.toggle(o&&s),this._isCustomRendered){var l=i.toolbar||[];this._buildToolbar(e,l,!1)}else{var a=i&&i.toolbar?i.toolbar:[],r=[];a.length&&(r=r.concat(a));var c,d=e.opts.toolbarItems||[];if(d.length&&(r.length&&r.push("separator"),r=r.concat(d)),(c=this._slideshowButtonItem(e))&&(r.length>0&&r.unshift("separator"),r.unshift(c)),"function"==typeof e.opts.onToolbar){var u=e.opts.onToolbar(e.items[e.idx],r.slice(),e);t.isArray(u)&&(r=u)}this._buildToolbar(e,r,!1!==n.download)}var p=this.$toolbar.children().length>0||o;this.$footer.toggle(p)},_updatePollOption:function(e,i){var n=e.opts.pollOption;if(this.$pollOption.removeClass("cv-active").empty(),!this._isHtmlItem&&n&&n.enabled&&null!=i.pollOptionLabel&&""!==String(i.pollOptionLabel).trim()){var o="checkbox"===n.mode?"checkbox":"radio",s=null!=i.pollOptionId?String(i.pollOptionId):"idx-"+e.idx;"radio"===o?void 0===e._pollSelectedValue&&(e._pollSelectedValue=null):e._pollSelectedSet||(e._pollSelectedSet=new Set);var l="radio"===o?e._pollSelectedValue===s:e._pollSelectedSet.has(s),a="cv-poll-"+e.id,r="cv-poll-input-"+e.id+"-"+s.replace(/[^a-z0-9-]/gi,"-"),d="radio"===o?'<input type="radio" name="'+c(a)+'" value="'+c(s)+'" id="'+c(r)+'"'+(l?" checked":"")+">":'<input type="checkbox" id="'+c(r)+'" value="'+c(s)+'"'+(l?" checked":"")+">",u=t('<div class="cv-poll-option-inner"><label class="cv-poll-option-label-wrap">'+d+'<span class="cv-poll-option-label">'+c(String(i.pollOptionLabel))+"</span></label></div>");this.$pollOption.append(u).addClass("cv-active"),u.find("input").on("change",function(){var t=this.checked;"radio"===o?e._pollSelectedValue=t?s:null:t?e._pollSelectedSet.add(s):e._pollSelectedSet.delete(s),"function"==typeof n.onSelect&&n.onSelect(i,t,e)})}},_buildToolbar:function(e,n,o){var s=this.$toolbar;if(s.empty(),this._renderToolbarItems(s,n,e),o){s.children().length>0&&s.append('<span class="cv-tb-sep"></span>');var l=!1!==e.opts.canShowTooltip?' data-cv-tooltip="'+c(a(0,"download"))+'"':"",u=t('<button class="cv-tb-btn cv-tb-download" type="button"'+l+">"+r.download+"</button>");u.on("click",function(t){t.preventDefault();var n=e.items[e.idx];if("function"==typeof e.opts.onDownload)e.opts.onDownload(n,e);else{var o=n.downloadUrl||n.src;if(!o||!p(o))return;var s=i.createElement("a");s.href=o,s.download=d(n.title),s.target="_blank",i.body.appendChild(s),s.click(),i.body.removeChild(s)}}),s.append(u)}},_renderToolbarItems:function(e,i,n){if(i&&i.length)for(var o=n.items[n.idx],s=0;s<i.length;s++){var l=i[s];if("separator"!==l&&"-"!==l)if(l instanceof HTMLElement||l instanceof t)e.append(l);else{var a=!0;if("function"==typeof l.visible?a=l.visible(o,n):!1===l.visible&&(a=!1),a){var r="";l.icon&&(r="<"===l.icon.charAt(0)?h(l.icon):'<i class="'+c(l.icon)+'"></i>');var d=l.label||"",u=null!=l.tooltip&&""!==l.tooltip?String(l.tooltip):d,p=!1!==n.opts.canShowTooltip&&""!==u,v=(u||l.id&&String(l.id))&&n.opts.wcag?' aria-label="'+c(u||l.id||"")+'"':"",f=p?' data-cv-tooltip="'+c(u)+'"':"",m=r;l.showLabel&&d&&(m+=' <span class="cv-tb-label">'+c(d)+"</span>");var g=t('<button class="cv-tb-btn'+(l.id?" cv-tb-"+c(String(l.id)):"")+(l.className?" "+c(String(l.className)):"")+'" type="button"'+f+v+">"+m+"</button>");"function"==typeof l.onClick&&function(t){g.on("click",function(e){e.preventDefault(),t(n.items[n.idx],n)})}(l.onClick),e.append(g)}}else e.append('<span class="cv-tb-sep"></span>')}}};function m(e,n,o,s){var l=!(s=s||{}).noDownload&&(o.src||o.downloadUrl),a=t('<div class="cv-error-card">'+r.error+'<p class="cv-error-text">'+c(n)+"</p>"+(l?'<button class="cv-error-dl" type="button">'+r.download+" Download source</button>":"")+"</div>");l&&a.find(".cv-error-dl").on("click",function(){var t=o.downloadUrl||o.src;if(t&&p(t)){var e=i.createElement("a");e.href=t,e.download=d(o.title),e.target="_blank",i.body.appendChild(e),e.click(),i.body.removeChild(e)}}),e.append(a)}function g(e,i){this.id=++g._counter,this.$container=e,this.opts=t.extend(!0,{},s,i);var n=this.opts.stageOnly;this.opts.stageOnly=!0===n||!1===n?{enabled:!!n,hideNavigation:!1}:n&&"object"==typeof n?t.extend({},s.stageOnly,n):t.extend({},s.stageOnly),this.items=[],this.idx=0,this._currentResult=null,this._collectItems(),this._bindClicks()}g._counter=0,g.prototype={constructor:g,_collectItems:function(){var e=this;this.items=[],this.$container.find(this.opts.selector).each(function(){var i=t(this),n={type:i.data("type")||"image",src:i.data("src")||i.attr("href")||i.find("img").attr("src"),title:i.data("title")||i.attr("title")||"",downloadUrl:i.data("download")||null,fileExt:i.data("ext")||null,fileSize:i.data("size")||null,mimeType:i.data("mime")||null,thumbnailUrl:i.data("thumbnail")||i.data("poster")||null,message:i.data("message")||null,html:i.data("html")||null,pollOptionLabel:i.data("pollOptionLabel")||null,pollOptionId:null!=i.data("pollOptionId")?i.data("pollOptionId"):null},o="function"==typeof e.opts.itemData?e.opts.itemData(i,n):n;null==o&&(o=n),o.$el=i,e.items.push(o)})},_bindClicks:function(){var t=this,e=".cv-"+this.id;this.$container.find(this.opts.selector).off(e).on("click"+e,function(e){e.preventDefault();var i=t.$container.find(t.opts.selector).index(this);i>=0&&t.open(i)})},open:function(t){this.idx="number"==typeof t?t:0,this._slideshowPaused=!1,this._slideshowPlaying=!1,f.open(this)},close:function(){f.close()},next:function(t){this.items.length<2||(this._slideshowTimer&&(clearTimeout(this._slideshowTimer),this._slideshowTimer=null),this._firePrevClose(this.items[this.idx]),this.idx=this.opts.loop?(this.idx+1)%this.items.length:Math.min(this.items.length-1,this.idx+1),f.loadItem(t&&t.transition?{transition:!0}:void 0))},prev:function(t){this.items.length<2||(this._slideshowTimer&&(clearTimeout(this._slideshowTimer),this._slideshowTimer=null),this._firePrevClose(this.items[this.idx]),this.idx=this.opts.loop?(this.idx-1+this.items.length)%this.items.length:Math.max(0,this.idx-1),f.loadItem(t&&t.transition?{transition:!0}:void 0))},goTo:function(t,e){t<0||t>=this.items.length||(this._slideshowTimer&&(clearTimeout(this._slideshowTimer),this._slideshowTimer=null),this._firePrevClose(this.items[this.idx]),this.idx=t,f.loadItem(e&&e.transition?{transition:!0}:void 0))},currentItem:function(){return this.items[this.idx]},setTheme:function(t){"dark"!==t&&"light"!==t||(this.opts.theme=t,f.activeInstance===this&&(f.$el[0].className="cv-overlay cv-theme-"+t,f._syncThemeToggle()),"function"==typeof this.opts.onThemeChange&&this.opts.onThemeChange(t,this))},refresh:function(){var t=f.visible&&f.activeInstance===this;this._collectItems(),this._bindClicks(),t&&this.items.length?(this.idx=Math.min(this.idx,this.items.length-1),f.loadItem()):t&&this.close()},destroy:function(){this.$container.find(this.opts.selector).off(".cv-"+this.id),this.$container.removeData("cv-instance"),f.activeInstance===this&&f.close(),this.items=[],this.opts=null},_firePrevClose:function(t){"function"==typeof this.opts.onClose&&t&&this.opts.onClose(t,this)}},t.fn[n]=function(e){if("string"==typeof e){var i,n=[].slice.call(arguments,1);return this.each(function(){var o=t(this).data("cv-instance");o&&"function"==typeof o[e]&&(i=o[e].apply(o,n))}),void 0!==i?i:this}return this.each(function(){var i=t(this);i.data("cv-instance")||i.data("cv-instance",new g(i,e))})},t.fn[n].defaults=s,t.fn[n].Icons=r,t.fn[n].defaultStrings=l}(jQuery,window,document);